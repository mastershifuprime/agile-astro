---
import Base from '@/layouts/Base.astro';
import PageHeader from '@/components/PageHeader.astro';
import CallToAction from '@/components/CallToAction.astro';
import { getCollection } from 'astro:content';

const webinars = await getCollection('webinars', ({ data }) => !data.draft);
const featuredWebinar = webinars.find(w => w.data.featured);
const otherWebinars = webinars.filter(w => !w.data.featured);
---
<Base title="Webinars - Agile">
  
<PageHeader title="Webinars" />

{featuredWebinar && (
<section class="section pt-4">
  <div class="container">
    <div class="row gy-5 items-center">
      <div class="col-12 lg:col-7">
        <div class="overflow-hidden rounded-lg bg-cover bg-no-repeat" style={`background-image: url('${featuredWebinar.data.image}')`}>
          <div class="left-0 top-0 flex flex-col items-center justify-center bg-theme-dark/60 px-3 py-14 text-white">
            <div class="text-center">
              <h4 class="mb-4 text-white">{featuredWebinar.data.title}</h4>
              <h5 class="font-primary text-lg font-normal text-white">
                {featuredWebinar.data.date}, {featuredWebinar.data.time}
              </h5>
              {featuredWebinar.data.speakers && featuredWebinar.data.speakers.length > 0 && (
                <div class="relative mt-[62px] flex items-center justify-center gap-8 rounded-lg bg-white px-4 py-5">
                  {featuredWebinar.data.speakers.map((speaker, i) => (
                    <div class="relative h-full px-4 py-2 text-center">
                      <img loading="lazy" class="mx-auto mb-3 w-16 h-16 rounded-full" src={speaker.image} alt={speaker.name}>
                      <h6 class="mb-1 text-dark">{speaker.name}</h6>
                      <p class="text-light text-sm">{speaker.role}</p>
                    </div>
                  ))}
                </div>
              )}
            </div>
          </div>
        </div>
      </div>
      <div class="lg:col-5">
        <h3 class="mb-4">
          <a class="transition-all duration-200 hover:text-primary" href="/webinar-single">{featuredWebinar.data.title}</a>
        </h3>
        <p class="mb-10">{featuredWebinar.data.excerpt}</p>
        <a href="/webinar-single" class="btn-lg btn-primary font-semibold shadow">Watch the Webinar</a>
      </div>
    </div>
  </div>
</section>
)}

<section class="section">
  <div class="container">
    <div class="lg:col-6 mx-auto text-center mb-12">
      <h2>All Webinars</h2>
      <p>Explore our library of on-demand webinars and upcoming live sessions.</p>
    </div>

    <div class="row g-4">
      {webinars.map((webinar) => (
        <div class="lg:col-4 md:col-6">
          <div class="rounded-lg shadow hover:shadow-lg transition-all duration-300 overflow-hidden">
            <img loading="lazy" class="w-full h-48 object-cover" src={webinar.data.image} alt={webinar.data.title}>
            <div class="p-6">
              <p class="text-sm text-primary mb-2">{webinar.data.date} â€¢ {webinar.data.time}</p>
              <h4 class="mb-3">
                <a class="hover:text-primary transition-colors" href="/webinar-single">{webinar.data.title}</a>
              </h4>
              <p class="text-light text-sm mb-4">{webinar.data.excerpt}</p>
              <a href="/webinar-single" class="btn btn-outline-primary">Watch Now</a>
            </div>
          </div>
        </div>
      ))}
    </div>
  </div>
</section>

<CallToAction />

</Base>
