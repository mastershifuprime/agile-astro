---
import Base from '@/layouts/Base.astro';
import PageHeader from '@/components/PageHeader.astro';
import CallToAction from '@/components/CallToAction.astro';
import { getCollection } from 'astro:content';

const customers = await getCollection('customers');
const sortedCustomers = customers.sort((a, b) => a.data.order - b.data.order);
const featuredCustomers = sortedCustomers.filter(c => c.data.featured);
const caseStudies = await getCollection('case-studies', ({ data }) => !data.draft);
---
<Base title="Customer Stories - Agile">
  
<PageHeader title="Customer Story" />

<section class="max-lg:pb-5 section-sm mx-lg:pb-5 pt-2">
    <div class="container">
        <div class="lg:col-6 mx-auto text-center">
            <h2 class="mb-14">Hear see the video why our customers love us.</h2>
        </div>
        <div class="lg:col-10 mx-auto">
            <div class="relative overflow-hidden rounded-lg">
                <img loading="lazy" data-thumnail class="cursor-pointer" width="1096" height="548"
                    src="/images/customer-story/1.png" alt="Webinars-img">
                <div class="hidden absolute top-0 left-0 w-full h-full">
                    <iframe class="w-full h-full" allowfullscreen
                        src="https://www.youtube.com/embed/ResipmZmpDU?autoplay=1&mute=1">
                    </iframe>
                </div>
            </div>
        </div>
    </div>
</section>

<section class="section pt-0">
    <div class="container">
        <div class="sm:col-10 lg:col-5 mx-auto text-center lg:mb-20">
            <h2>We're all on the same events team</h2>
        </div>

        <div class="mt-6 space-y-16">
            {caseStudies.map((study, index) => (
                <div class="row gy-4 items-center">
                    <div class={`md:col-6 ${index % 2 === 0 ? 'order-2 md:order-1' : 'order-2'}`}>
                        <img loading="lazy" class="mb-3" src={study.data.logo} alt={study.data.company} />
                        <h3 class="max-lg:h4 mb-4">
                            <a href="/case-study">{study.data.title}</a>
                        </h3>
                        <p class="mb-4 lg:mb-10 text-light">{study.data.excerpt}</p>
                        <a href="/case-study" class="btn py-2 text-lg font-semibold px-8 capitalize btn-outline-primary">learn more</a>
                    </div>
                    <div class={`md:col-6 ${index % 2 === 0 ? 'order-1 md:order-2' : 'order-1'}`}>
                        <div class="overflow-hidden relative">
                            <img loading="lazy" width="742" height="442" class="rounded-xl w-full" src={study.data.image} alt={study.data.company}>
                        </div>
                    </div>
                </div>
            ))}
        </div>
    </div>
</section>

<!-- Customer Testimonials -->
<section class="section bg-theme-light">
    <div class="container">
        <div class="lg:col-6 mx-auto text-center mb-12">
            <h2>What Our Customers Say</h2>
        </div>
        
        <div class="row g-4">
            {sortedCustomers.map((customer) => (
                <div class="lg:col-4 md:col-6">
                    <div class="bg-white rounded-xl p-8 shadow hover:shadow-lg transition-all duration-300">
                        <svg class="text-primary mb-4" width="40" height="32" viewBox="0 0 12 10" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M4.78151 0V2.00786C4.14576 2.04288 3.66438 2.15873 3.33786 2.35563C3.01109 2.55254 2.78155 2.8718 2.64899 3.31365C2.51667 3.7555 2.45027 4.38751 2.45027 5.20992H4.78151V10H0L0 5.44611C0 3.5651 0.403951 2.18725 1.21185 1.3123C2.02001 0.43735 3.20981 0 4.78151 0ZM12 0V2.00786C11.3643 2.04288 10.8831 2.15447 10.5564 2.34262C10.2296 2.53052 9.99328 2.85003 9.84768 3.30064C9.70209 3.751 9.62917 4.38751 9.62917 5.20992H12V10H7.19218V5.44611C7.19218 3.5651 7.59388 2.18725 8.39727 1.3123C9.20091 0.43735 10.4017 0 12 0Z" fill="currentColor"/>
                        </svg>
                        <p class="text-light mb-6 italic">"{customer.data.quote}"</p>
                        <div class="flex items-center gap-4">
                            {customer.data.image && (
                                <img loading="lazy" class="w-12 h-12 rounded-full" src={customer.data.image} alt={customer.data.name}>
                            )}
                            <div>
                                <h5 class="text-primary">{customer.data.name}</h5>
                                <p class="text-sm text-light">{customer.data.role}, {customer.data.company}</p>
                            </div>
                        </div>
                    </div>
                </div>
            ))}
        </div>
    </div>
</section>

<CallToAction />

</Base>
