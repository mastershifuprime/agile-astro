---
import '../styles/global.css';
import { ViewTransitions } from 'astro:transitions';
import config from '@/config/config.json';
import Header from '@/layouts/partials/Header.astro';
import Footer from '@/layouts/partials/Footer.astro';

export interface Props {
  title?: string;
  meta_title?: string;
  description?: string;
  image?: string;
  noindex?: boolean;
  canonical?: string;
}

const { title, meta_title, description, image, noindex, canonical } = Astro.props;

const siteTitle = meta_title || title || config.site.title;
const siteDescription = description || config.metadata.meta_description;
---

<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5" />
  <link rel="icon" type="image/png" href={config.site.favicon} />
  <meta name="generator" content={Astro.generator} />
  
  <title>{siteTitle}</title>
  <meta name="description" content={siteDescription} />
  <meta name="author" content={config.metadata.meta_author} />
  
  {noindex && <meta name="robots" content="noindex, nofollow" />}
  {canonical && <link rel="canonical" href={canonical} />}
  
  <!-- Open Graph -->
  <meta property="og:title" content={siteTitle} />
  <meta property="og:description" content={siteDescription} />
  <meta property="og:type" content="website" />
  <meta property="og:image" content={image || config.metadata.meta_image} />
  
  <!-- Twitter Card -->
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:title" content={siteTitle} />
  <meta name="twitter:description" content={siteDescription} />
  
  <!-- Google Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@400;600;700&family=Source+Serif+Pro:wght@600;700&display=swap" rel="stylesheet" />
  
  <!-- Swiper CSS -->
  <link rel="stylesheet" href="/plugins/swiper/swiper-bundle.css" />
  
  <!-- Font Awesome -->
  <link rel="stylesheet" href="/plugins/font-awesome/v6/brands.css" />
  <link rel="stylesheet" href="/plugins/font-awesome/v6/solid.css" />
  <link rel="stylesheet" href="/plugins/font-awesome/v6/regular.css" />
  <link rel="stylesheet" href="/plugins/font-awesome/v6/fontawesome.css" />
  
  <!-- View Transitions for SPA-like navigation -->
  <ViewTransitions />
</head>
<body>
  <Header />
  
  <main>
    <slot />
  </main>
  
  <Footer />
  
  <!-- Swiper JS -->
  <script is:inline src="/plugins/swiper/swiper-bundle.js"></script>
  <!-- Shuffle JS -->
  <script is:inline src="/plugins/shuffle/shuffle.min.js"></script>
  <!-- Main Script -->
  <script>
    function initScripts() {
      const mainScript = document.createElement('script');
      mainScript.src = '/scripts/main.js';
      document.body.appendChild(mainScript);
    }
    initScripts();
    document.addEventListener('astro:after-swap', initScripts);
  </script>
  
  <!-- ThriveDesk Assistant -->
  <script is:inline>
    var ASSISTANT_ID = "a1149dc4-5eb6-44aa-a893-5f3819e5d340";
    !function(t,e,n){function s(){
      const t=e.getElementsByTagName("script")[0],n=e.createElement("script");
      n.type="text/javascript",n.async=!0,n.src="https://assistant.thrivedesk.io/bootloader.js?"+Date.now(),
      t.parentNode.insertBefore(n,t)}if(t.Assistant=n=function(e,n,s){t.Assistant.readyQueue.push({method:e,options:n,data:s})},
      n.readyQueue=[],"complete"===e.readyState)return s();
    t.attachEvent?t.attachEvent("onload",s):t.addEventListener("load",s,!1)}
    (window,document,window.Assistant||function(){}),window.Assistant("init", ASSISTANT_ID);
  </script>
</body>
</html>
